
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="it">
  <head>
    <meta charset="utf-8" />
    <title>Server RMAP &#8212; RMAP e Stima 3 documentazione</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="index" title="Indice" href="../genindex.html" />
    <link rel="search" title="Cerca" href="../search.html" />
    <link rel="prev" title="Stima-wifi" href="../stima_wifi/stima_wifi_howto.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="server-rmap">
<h1>Server RMAP<a class="headerlink" href="#server-rmap" title="Link a questa intestazione">¶</a></h1>
<div class="section" id="installazione-sistema-operativo-centos-8">
<h2>Installazione sistema operativo Centos 8<a class="headerlink" href="#installazione-sistema-operativo-centos-8" title="Link a questa intestazione">¶</a></h2>
<p>Installare Centos 8.</p>
<p>Aggiunta repository e installazione pacchetti</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dnf</span> <span class="o">-</span><span class="n">y</span> <span class="n">install</span> <span class="n">epel</span><span class="o">-</span><span class="n">release</span>
<span class="n">dnf</span> <span class="n">install</span> <span class="n">yum</span><span class="o">-</span><span class="n">plugin</span><span class="o">-</span><span class="n">copr</span>
<span class="n">dnf</span> <span class="n">copr</span> <span class="n">enable</span> <span class="n">simc</span><span class="o">/</span><span class="n">stable</span>
<span class="n">dnf</span> <span class="n">copr</span> <span class="n">enable</span> <span class="n">pat1</span><span class="o">/</span><span class="n">rmap</span>
<span class="n">dnf</span> <span class="n">config</span><span class="o">-</span><span class="n">manager</span> <span class="o">--</span><span class="nb">set</span><span class="o">-</span><span class="n">enabled</span> <span class="n">PowerTool</span>
<span class="n">dnf</span> <span class="n">groupinstall</span> <span class="n">rmap</span>
<span class="n">dnf</span> <span class="n">copr</span> <span class="n">enable</span> <span class="n">simc</span><span class="o">/</span><span class="n">cosudo</span>
<span class="n">dnf</span> <span class="n">install</span> <span class="n">python3</span><span class="o">-</span><span class="n">django</span><span class="o">-</span><span class="n">dynamic</span><span class="o">-</span><span class="nb">map</span><span class="o">-</span><span class="n">borinud</span>
<span class="n">dnf</span> <span class="n">install</span> <span class="n">mosquitto</span> <span class="n">mosquitto</span><span class="o">-</span><span class="n">auth</span><span class="o">-</span><span class="n">plug</span>
<span class="n">dnf</span> <span class="n">install</span> <span class="n">arkimet</span>
<span class="n">useradd</span> <span class="n">rmap</span>
</pre></div>
</div>
<p>/etc/selinux/config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELINUX</span><span class="o">=</span><span class="n">disabled</span>
</pre></div>
</div>
<p><a class="reference external" href="https://raw.githubusercontent.com/r-map/rmap/master/server/etc/tmpfiles.d/rmap.conf">/etc/tmpfiles.d/rmap.conf</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="o">/</span><span class="n">rmap</span>
<span class="n">chmod</span> <span class="n">go</span><span class="o">+</span><span class="n">rx</span> <span class="o">/</span><span class="n">rmap</span>
</pre></div>
</div>
<p><a class="reference external" href="https://raw.githubusercontent.com/r-map/rmap/master/server/etc/sysconfig/crond">/etc/sysconfig/crond</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">rmap</span>
<span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">rmap</span><span class="p">:</span><span class="n">rmap</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">rmap</span>
</pre></div>
</div>
</div>
<div class="section" id="postgresql">
<h2>postgresql<a class="headerlink" href="#postgresql" title="Link a questa intestazione">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dnf</span> <span class="n">module</span> <span class="n">disable</span> <span class="n">postgresql</span><span class="p">:</span><span class="mi">10</span>
<span class="n">dnf</span> <span class="n">module</span> <span class="n">enable</span> <span class="n">postgresql</span><span class="p">:</span><span class="mi">12</span>
<span class="n">dnf</span> <span class="n">install</span> <span class="n">postgresql</span><span class="o">-</span><span class="n">server</span> <span class="n">postgresql</span><span class="o">-</span><span class="n">contrib</span>
<span class="n">dnf</span> <span class="n">installpython3</span><span class="o">-</span><span class="n">psycopg2</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">postgresql</span><span class="o">-</span><span class="n">setup</span> <span class="o">--</span><span class="n">initdb</span> <span class="o">--</span><span class="n">unit</span> <span class="n">postgresql</span>
</pre></div>
</div>
<p><a class="reference external" href="https://raw.githubusercontent.com/r-map/rmap/master/server/var/lib/pgsql/data/pg_hba.conf">/var/lib/pgsql/data/pg_hba.conf</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/r-map/rmap/master/server/var/lib/pgsql/data/postgresql.conf">/var/lib/pgsql/data/postgresql.conf</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">postgresql</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">d</span><span class="o">/</span>
</pre></div>
</div>
<p><a class="reference external" href="https://raw.githubusercontent.com/r-map/rmap/master/server/etc/systemd/system/postgresql.service.d/rmap.conf">/etc/systemd/system/postgresql.service.d/rmap.conf</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="o">/</span><span class="n">rmap</span><span class="o">/</span><span class="n">pgsql</span><span class="o">/</span>
<span class="n">chown</span> <span class="n">postgres</span><span class="p">:</span><span class="n">postgres</span> <span class="o">/</span><span class="n">rmap</span><span class="o">/</span><span class="n">pgsql</span><span class="o">/</span>
<span class="n">mv</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">pgsql</span><span class="o">/</span><span class="n">data</span> <span class="o">/</span><span class="n">rmap</span><span class="o">/</span><span class="n">pgsql</span><span class="o">/</span>

<span class="n">su</span> <span class="o">-</span> <span class="n">postgres</span>
<span class="n">initdb</span>
<span class="n">exit</span>

<span class="n">systemctl</span> <span class="n">enable</span> <span class="n">postgresql</span><span class="o">.</span><span class="n">service</span>
<span class="n">systemctl</span> <span class="n">start</span> <span class="n">postgresql</span><span class="o">.</span><span class="n">service</span>

<span class="n">su</span> <span class="o">-</span> <span class="n">postgres</span>
<span class="n">createuser</span> <span class="o">-</span><span class="n">P</span> <span class="o">-</span><span class="n">e</span> <span class="n">rmapadmin</span>
<span class="n">createdb</span> <span class="o">--</span><span class="n">owner</span><span class="o">=</span><span class="n">rmapadmin</span> <span class="n">rmapadmin</span>
<span class="n">exit</span>
</pre></div>
</div>
<p><a class="reference external" href="https://raw.githubusercontent.com/r-map/rmap/master/server/etc/rmap/rmap-site.cfg">/etc/rmap/rmap-site.cfg</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/r-map/rmap/master/server/etc/rmap/dashboard.conf">/etc/rmap/dashboard.conf</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/r-map/rmap/master/server/etc/rmap/graphTemplates.conf">/etc/rmap/graphTemplates.conf</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rmapctrl</span> <span class="o">--</span><span class="n">syncdb</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">su</span> <span class="o">-</span> <span class="n">postgres</span>
<span class="n">createuser</span> <span class="o">-</span><span class="n">P</span> <span class="o">-</span><span class="n">e</span> <span class="n">rmap</span>
<span class="n">createdb</span> <span class="o">--</span><span class="n">owner</span><span class="o">=</span><span class="n">rmap</span> <span class="n">report_fixed</span>
<span class="n">createdb</span> <span class="o">--</span><span class="n">owner</span><span class="o">=</span><span class="n">rmap</span> <span class="n">report_mobile</span>
<span class="n">createdb</span> <span class="o">--</span><span class="n">owner</span><span class="o">=</span><span class="n">rmap</span> <span class="n">sample_fixed</span>
<span class="n">createdb</span> <span class="o">--</span><span class="n">owner</span><span class="o">=</span><span class="n">rmap</span> <span class="n">sample_mobile</span>

<span class="n">exit</span>
</pre></div>
</div>
</div>
<div class="section" id="apache">
<h2>apache<a class="headerlink" href="#apache" title="Link a questa intestazione">¶</a></h2>
<p>Collect static files from django apps:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">global_static</span>
<span class="n">rmapctrl</span> <span class="o">--</span><span class="n">collectstatic</span>
<span class="n">rmdir</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">global_static</span>

<span class="n">yum</span> <span class="n">install</span> <span class="n">python3</span><span class="o">-</span><span class="n">mod_wsgi</span>

<span class="n">useradd</span> <span class="o">-</span><span class="n">r</span> <span class="n">rmap</span>
<span class="n">mkdir</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">rmap</span>
<span class="n">chown</span> <span class="n">rmap</span><span class="p">:</span><span class="n">rmap</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">rmap</span>
<span class="n">mkdir</span> <span class="o">/</span><span class="n">rmap</span><span class="o">/</span><span class="n">cache</span>
<span class="n">chown</span> <span class="n">rmap</span><span class="p">:</span><span class="n">rmap</span> <span class="o">/</span><span class="n">rmap</span><span class="o">/</span><span class="n">cache</span>
</pre></div>
</div>
<p><a class="reference external" href="https://raw.githubusercontent.com/r-map/rmap/master/server/etc/httpd/conf.modules.d/00-mpm.conf">/etc/httpd/conf.modules.d/00-mpm.conf</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/r-map/rmap/master/server/etc/httpd/conf.d/rmap.conf">/etc/httpd/conf.d/rmap.conf</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/r-map/rmap/master/server/etc/httpd/conf.d/rmap.inc">/etc/httpd/conf.d/rmap.inc</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>chkconfig httpd on``
service httpd start``
</pre></div>
</div>
</div>
<div class="section" id="arkimet">
<h2>Arkimet<a class="headerlink" href="#arkimet" title="Link a questa intestazione">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dnf</span> <span class="n">install</span> <span class="n">arkimet</span> <span class="n">arkimet</span><span class="o">-</span><span class="n">postprocessor</span><span class="o">-</span><span class="n">suite</span>
<span class="n">useradd</span>  <span class="o">-</span><span class="n">r</span> <span class="n">arkimet</span>
<span class="n">mkdir</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">arkimet</span>
<span class="n">chown</span> <span class="n">arkimet</span><span class="p">:</span><span class="n">arkimet</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">arkimet</span>
<span class="n">mkdir</span> <span class="o">/</span><span class="n">rmap</span><span class="o">/</span><span class="n">arkimet</span><span class="o">/</span>
<span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">arkimet</span><span class="p">:</span><span class="n">arkimet</span> <span class="o">/</span><span class="n">rmap</span><span class="o">/</span><span class="n">arkimet</span><span class="o">/</span>
<span class="n">mkdir</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">arkimet</span>
<span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">arkimet</span><span class="p">:</span><span class="n">arkimet</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">arkimet</span>
</pre></div>
</div>
<p><a class="reference external" href="https://raw.githubusercontent.com/r-map/rmap/master/server/etc/sysconfig/arkimet">/etc/sysconfig/arkimet</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/r-map/rmap/master/server/etc/arkimet/scan/bufr_generic_mobile_rmap.py">/etc/arkimet/scan/bufr_generic_mobile_rmap.py</a></p>
<p>Replicate structure in:</p>
<p><a class="reference external" href="https://github.com/r-map/rmap/tree/master/server/rmap/arkimet">/rmap/arkimet</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">systemctl</span> <span class="n">daemon</span><span class="o">-</span><span class="n">reload</span>
<span class="n">chkconfig</span> <span class="n">arkimet</span> <span class="n">on</span>
<span class="n">service</span> <span class="n">arkimet</span> <span class="n">start</span>
</pre></div>
</div>
</div>
<div class="section" id="mosquitto">
<h2>Mosquitto<a class="headerlink" href="#mosquitto" title="Link a questa intestazione">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">mosquitto</span><span class="o">/</span><span class="n">conf</span><span class="o">.</span><span class="n">d</span>
<span class="n">mkdir</span> <span class="o">/</span><span class="n">rmap</span><span class="o">/</span><span class="n">mosquitto</span>
<span class="n">chown</span> <span class="n">mosquitto</span><span class="p">:</span><span class="n">mosquitto</span> <span class="o">/</span><span class="n">rmap</span><span class="o">/</span><span class="n">mosquitto</span>
</pre></div>
</div>
<p><a class="reference external" href="https://raw.githubusercontent.com/r-map/rmap/master/server/etc/mosquitto/conf.d/rmap.conf">/etc/mosquitto/conf.d/rmap.conf</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/r-map/rmap/master/server/etc/mosquitto/aclfile">/etc/mosquitto/aclfile</a></p>
<p>remove everythings and add in /etc/mosquitto/mosquitto.conf</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">include_dir</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">mosquitto</span><span class="o">/</span><span class="n">conf</span><span class="o">.</span><span class="n">d</span>
<span class="n">pid_file</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">mosquitto</span><span class="o">.</span><span class="n">pid</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">touch</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">mosquitto</span><span class="o">/</span><span class="n">pwfile</span>
<span class="n">chkconfig</span> <span class="n">mosquitto</span> <span class="n">on</span>
<span class="n">service</span> <span class="n">mosquitto</span> <span class="n">start</span>
</pre></div>
</div>
<p>if the package use systemV create:</p>
<p><a class="reference external" href="https://raw.githubusercontent.com/r-map/rmap/master/server/etc/monit.d/mosquitto">/etc/monit.d/mosquitto</a></p>
</div>
<div class="section" id="rabbitmq">
<h2>Rabbitmq<a class="headerlink" href="#rabbitmq" title="Link a questa intestazione">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">s</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">packagecloud</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">install</span><span class="o">/</span><span class="n">repositories</span><span class="o">/</span><span class="n">rabbitmq</span><span class="o">/</span><span class="n">rabbitmq</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">script</span><span class="o">.</span><span class="n">rpm</span><span class="o">.</span><span class="n">sh</span> <span class="o">|</span><span class="n">bash</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">s</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">packagecloud</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">install</span><span class="o">/</span><span class="n">repositories</span><span class="o">/</span><span class="n">rabbitmq</span><span class="o">/</span><span class="n">erlang</span><span class="o">/</span><span class="n">script</span><span class="o">.</span><span class="n">rpm</span><span class="o">.</span><span class="n">sh</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">bash</span>

<span class="n">dnf</span> <span class="n">install</span> <span class="n">rabbitmq</span><span class="o">-</span><span class="n">server</span>
</pre></div>
</div>
<p><a class="reference external" href="https://raw.githubusercontent.com/r-map/rmap/master/server/etc/rabbitmq/enabled_plugins">/etc/rabbitmq/enabled_plugins</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/r-map/rmap/master/server/etc/rabbitmq/rabbitmq-env.conf">/etc/rabbitmq/rabbitmq-env.conf</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/r-map/rmap/master/server/etc/rabbitmq/rabbitmq.config">/etc/rabbitmq/rabbitmq.config</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chkconfig</span> <span class="n">rabbitmq</span><span class="o">-</span><span class="n">server</span> <span class="n">on</span>
<span class="n">service</span> <span class="n">rabbitmq</span><span class="o">-</span><span class="n">server</span> <span class="n">start</span>
</pre></div>
</div>
<p>login at management interface with user «guest» and password «guest»
on overview page use import definition to configure exchange, queue and users
with the same management interface remove «guest» user and login with a new real user</p>
<p>Per attivare uno showell:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rabbitmqctl</span> <span class="n">set_parameter</span> <span class="n">shovel</span> <span class="n">report_mobile</span> <span class="s1">&#39;{&quot;src-protocol&quot;: &quot;amqp091&quot;, &quot;src-uri&quot;: &quot;amqp://rmap:&lt;password&gt;@rmap.cc&quot;, &quot;src-queue&quot;: &quot;report_mobile_saved&quot;, &quot;dest-protocol&quot;: &quot;amqp091&quot;, &quot;dest-uri&quot;: &quot;amqp://rmap:&lt;password&gt;@&quot;, &quot;dest-queue&quot;: &quot;report_mobile&quot;}&#39;</span>
</pre></div>
</div>
<p>problema non risolto:
se si trasferiscono dati scritti da un utente autenticandosi con un altro utente la security su user_id lo vieta.
<a class="reference external" href="https://www.rabbitmq.com/shovel-dynamic.html">https://www.rabbitmq.com/shovel-dynamic.html</a>
bisognerebbe riuscire a settare «user_id» tramite il parametro «dest-publish-properties» nel formato json sopra ma non funziona</p>
</div>
<div class="section" id="monit">
<h2>Monit<a class="headerlink" href="#monit" title="Link a questa intestazione">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">yum</span> <span class="n">install</span> <span class="n">monit</span>
</pre></div>
</div>
<p><a class="reference external" href="https://raw.githubusercontent.com/r-map/rmap/master/server/etc/monitrc">/etc/monitrc</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/r-map/rmap/master/server/etc/monit.d/rmap">/etc/monit.d/rmap</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chkconfig</span> <span class="n">monit</span> <span class="n">on</span>
<span class="n">service</span> <span class="n">monit</span> <span class="n">start</span>
</pre></div>
</div>
</div>
<div class="section" id="cron">
<h2>Cron<a class="headerlink" href="#cron" title="Link a questa intestazione">¶</a></h2>
<p><a class="reference external" href="https://raw.githubusercontent.com/r-map/rmap/master/server/etc/cron.d/arpae_aq_ckan">/etc/cron.d/arpae_aq_ckan</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/r-map/rmap/master/server/etc/cron.d/dballe2arkimet">/etc/cron.d/dballe2arkimet</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/r-map/rmap/master/server/etc/cron.d/luftdaten">/etc/cron.d/luftdaten</a></p>
<p><a class="reference external" href="https://raw.githubusercontent.com/r-map/rmap/master/server/etc/cron.d/makeexplorer">/etc/cron.d/makeexplorer</a></p>
</div>
<div class="section" id="sincronizzazione-db-da-un-server">
<h2>Sincronizzazione DB da un server<a class="headerlink" href="#sincronizzazione-db-da-un-server" title="Link a questa intestazione">¶</a></h2>
<div class="section" id="server-di-origine">
<h3>Server di origine<a class="headerlink" href="#server-di-origine" title="Link a questa intestazione">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rmapctrl</span> <span class="o">--</span><span class="n">dumpdata</span> <span class="o">&gt;</span> <span class="n">dumpdata</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>rimuovere le prime righe che non sono json</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dbadb</span> <span class="n">export</span> <span class="o">--</span><span class="n">dsn</span><span class="o">=</span><span class="s2">&quot;mysql:///report_fixed?user=rmap&amp;password=****&quot;</span> <span class="o">&gt;</span> <span class="n">report_fixed</span><span class="o">.</span><span class="n">bufr</span>
<span class="n">dbadb</span> <span class="n">export</span> <span class="o">--</span><span class="n">dsn</span><span class="o">=</span><span class="s2">&quot;mysql:///report_mobile?user=rmap&amp;password=****&quot;</span> <span class="o">&gt;</span> <span class="n">report_mobile</span><span class="o">.</span><span class="n">bufr</span>
<span class="n">dbadb</span> <span class="n">export</span> <span class="o">--</span><span class="n">dsn</span><span class="o">=</span><span class="s2">&quot;mysql:///sample_fixed?user=rmap&amp;password=****&quot;</span> <span class="o">&gt;</span> <span class="n">sample_fixed</span><span class="o">.</span><span class="n">bufr</span>
<span class="n">dbadb</span> <span class="n">export</span> <span class="o">--</span><span class="n">dsn</span><span class="o">=</span><span class="s2">&quot;mysql:///sample_mobile?user=rmap&amp;password=****&quot;</span> <span class="o">&gt;</span> <span class="n">sample_mobile</span><span class="o">.</span><span class="n">bufr</span>
</pre></div>
</div>
</div>
<div class="section" id="server-di-destinazione">
<h3>Server di destinazione<a class="headerlink" href="#server-di-destinazione" title="Link a questa intestazione">¶</a></h3>
<p>Da interfaccia web admin rimuovere TUTTI gli utenti (compreso rmap)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rmapctrl</span> <span class="o">--</span><span class="n">loaddata</span><span class="o">=</span><span class="n">dumpdata</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dbadb</span> <span class="kn">import</span> <span class="o">--</span><span class="n">wipe</span><span class="o">-</span><span class="n">first</span> <span class="o">--</span><span class="n">dsn</span><span class="o">=</span><span class="s2">&quot;postgresql://rmap:***@localhost/report_fixed&quot;</span> <span class="n">report_fixed</span><span class="o">.</span><span class="n">bufr</span>
<span class="n">dbadb</span> <span class="kn">import</span> <span class="o">--</span><span class="n">wipe</span><span class="o">-</span><span class="n">first</span> <span class="o">--</span><span class="n">dsn</span><span class="o">=</span><span class="s2">&quot;postgresql://rmap:***@localhost/report_mobile&quot;</span> <span class="n">report_mobile</span><span class="o">.</span><span class="n">bufr</span>
<span class="n">dbadb</span> <span class="kn">import</span> <span class="o">--</span><span class="n">wipe</span><span class="o">-</span><span class="n">first</span> <span class="o">--</span><span class="n">dsn</span><span class="o">=</span><span class="s2">&quot;postgresql://rmap:***@localhost/sample_mobile&quot;</span> <span class="n">sample_mobile</span><span class="o">.</span><span class="n">bufr</span>
<span class="n">dbadb</span> <span class="kn">import</span> <span class="o">--</span><span class="n">wipe</span><span class="o">-</span><span class="n">first</span> <span class="o">--</span><span class="n">dsn</span><span class="o">=</span><span class="s2">&quot;postgresql://rmap:***@localhost/sample_fixed&quot;</span> <span class="n">sample_fixed</span><span class="o">.</span><span class="n">bufr</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">rmap</span><span class="o">/</span>
<span class="n">rsync</span> <span class="o">-</span><span class="n">av</span> <span class="n">utente</span><span class="nd">@serverorigine</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">rmap</span><span class="o">/</span><span class="n">media</span> <span class="o">.</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="arkiweb">
<h2>Arkiweb<a class="headerlink" href="#arkiweb" title="Link a questa intestazione">¶</a></h2>
<p>AL MOMENTO NON DISPONIBILE SU CENTOS 8
NOT AVAILABLE ON CENTOS 8</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dnf</span> <span class="n">install</span> <span class="n">arkiweb</span>
</pre></div>
</div>
<p>/etc/httpd/conf.d/arkiweb.conf</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ScriptAlias</span> <span class="o">/</span><span class="n">services</span><span class="o">/</span><span class="n">arkiweb</span><span class="o">/</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib64</span><span class="o">/</span><span class="n">arkiweb</span><span class="o">/</span>
<span class="n">Alias</span> <span class="o">/</span><span class="n">arkiweb</span>  <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">arkiweb</span>

<span class="o">&lt;</span><span class="n">Directory</span> <span class="s2">&quot;/usr/lib64/arkiweb&quot;</span><span class="o">&gt;</span>
       <span class="n">AllowOverride</span> <span class="kc">None</span>
       <span class="n">Options</span> <span class="o">+</span><span class="n">ExecCGI</span>

       <span class="n">Order</span> <span class="n">allow</span><span class="p">,</span><span class="n">deny</span>
       <span class="n">Allow</span> <span class="kn">from</span> <span class="nn">all</span>

       <span class="c1"># ARKIWEB_CONFIG is mandatory!</span>
       <span class="n">SetEnv</span> <span class="n">ARKIWEB_CONFIG</span> <span class="o">/</span><span class="n">rmap</span><span class="o">/</span><span class="n">arkimet</span><span class="o">/</span><span class="n">arkiweb</span><span class="o">.</span><span class="n">config</span>


       <span class="n">Require</span> <span class="nb">all</span> <span class="n">granted</span>

       <span class="c1"># Authentication (optional)</span>
       <span class="c1">#</span>
       <span class="c1"># Basic authentication example:</span>
       <span class="c1"># SetEnv ARKIWEB_RESTRICT REMOTE_USER</span>
       <span class="c1"># AuthType Basic</span>
       <span class="c1"># AuthUserFile /etc/arkiweb.passwords</span>
       <span class="c1"># require valid-user</span>
<span class="o">&lt;/</span><span class="n">Directory</span><span class="o">&gt;</span>

<span class="n">Alias</span> <span class="o">/</span><span class="n">arkiwebjs</span><span class="o">/</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">arkiweb</span><span class="o">/</span><span class="n">public</span><span class="o">/</span>
<span class="o">&lt;</span><span class="n">Directory</span> <span class="s2">&quot;/usr/share/arkiweb/public&quot;</span><span class="o">&gt;</span>
          <span class="c1">#Require all granted</span>
          <span class="n">AllowOverride</span> <span class="kc">None</span>

          <span class="n">Order</span> <span class="n">allow</span><span class="p">,</span><span class="n">deny</span>
          <span class="n">Allow</span> <span class="kn">from</span> <span class="nn">all</span>

          <span class="n">Require</span> <span class="nb">all</span> <span class="n">granted</span>

<span class="o">&lt;/</span><span class="n">Directory</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">arkiweb</span><span class="o">/</span>
<span class="n">cp</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">doc</span><span class="o">/</span><span class="n">arkiweb</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">example</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">html</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">arkiweb</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">html</span>
</pre></div>
</div>
<p>/rmap/arkimet/arkiweb.config</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo_stima.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../index.html">RMAP e Stima</a></h1>








<h3>Navigazione</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../rmap_rfc/rfc.html">RFC rmap versione 2.7</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stima_v3/stima_v3.html">Stima V3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stima_wifi/stima_wifi_howto.html">Stima-wifi</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Server RMAP</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installazione-sistema-operativo-centos-8">Installazione sistema operativo Centos 8</a></li>
<li class="toctree-l2"><a class="reference internal" href="#postgresql">postgresql</a></li>
<li class="toctree-l2"><a class="reference internal" href="#apache">apache</a></li>
<li class="toctree-l2"><a class="reference internal" href="#arkimet">Arkimet</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mosquitto">Mosquitto</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rabbitmq">Rabbitmq</a></li>
<li class="toctree-l2"><a class="reference internal" href="#monit">Monit</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cron">Cron</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sincronizzazione-db-da-un-server">Sincronizzazione DB da un server</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#server-di-origine">Server di origine</a></li>
<li class="toctree-l3"><a class="reference internal" href="#server-di-destinazione">Server di destinazione</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#arkiweb">Arkiweb</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="../stima_wifi/stima_wifi_howto.html" title="capitolo precedente">Stima-wifi</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Ricerca veloce</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Vai" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Various.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/server_rmap/server_rmap.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>